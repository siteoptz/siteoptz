<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GA4 Events Test - SiteOptz.ai</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #f9f9f9;
        }
        .test-section h3 {
            color: #555;
            margin-top: 0;
        }
        button {
            background: #007cba;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        button:hover {
            background: #005a87;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .test-results {
            margin-top: 20px;
            padding: 15px;
            background: #f0f0f0;
            border-radius: 5px;
            max-height: 400px;
            overflow-y: auto;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 3px;
            background: white;
        }
        .success {
            border-left: 4px solid #4CAF50;
        }
        .error {
            border-left: 4px solid #f44336;
        }
        .info {
            border-left: 4px solid #2196F3;
        }
        .debug-dashboard {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 300px;
            background: #fff;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            font-family: monospace;
            font-size: 12px;
        }
        .debug-dashboard h4 {
            margin-top: 0;
            color: #333;
        }
        .debug-stats {
            margin: 10px 0;
        }
        .debug-stats div {
            margin: 5px 0;
        }
        .clear-btn {
            background: #f44336;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        .clear-btn:hover {
            background: #d32f2f;
        }
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .status-online {
            background: #4CAF50;
        }
        .status-offline {
            background: #f44336;
        }
        .status-unknown {
            background: #ff9800;
        }
    </style>
</head>
<body>
    <!-- Debug Dashboard -->
    <div class="debug-dashboard">
        <h4>üîç GA4 Debug Dashboard</h4>
        <div class="debug-stats" id="debug-stats">
            <div><span class="status-indicator status-unknown"></span>GA4 Status: Checking...</div>
            <div>Session ID: <span id="session-id">Loading...</span></div>
            <div>Events Stored: <span id="events-count">0</span></div>
            <div>Debug Mode: <span id="debug-mode">Unknown</span></div>
            <div>Last Event: <span id="last-event">None</span></div>
            <div>Test Results: <span id="test-count">0</span></div>
        </div>
        <button class="clear-btn" onclick="clearDebugData()">Clear All Data</button>
    </div>

    <div class="container">
        <h1>üéØ GA4 Key Events Test - SiteOptz.ai</h1>
        
        <div class="test-section">
            <h3>üìß Lead Generation Events</h3>
            <button onclick="testEmailCapture()">Test Email Capture</button>
            <button onclick="testWebinarRegistration()">Test Webinar Registration</button>
            <button onclick="testGuideDownload()">Test Guide Download</button>
            <button onclick="testPricingQuote()">Test Pricing Quote Request</button>
        </div>

        <div class="test-section">
            <h3>üîç Engagement Events</h3>
            <button onclick="testComparisonView()">Test Comparison View</button>
            <button onclick="testCalculatorUsage()">Test Calculator Usage</button>
            <button onclick="testFAQInteraction()">Test FAQ Interaction</button>
            <button onclick="testToolSelection()">Test Tool Selection</button>
            <button onclick="testFeatureComparison()">Test Feature Comparison</button>
        </div>

        <div class="test-section">
            <h3>üí∞ Conversion Events</h3>
            <button onclick="testAffiliateClick()">Test Affiliate Click</button>
            <button onclick="testToolSignup()">Test Tool Signup</button>
            <button onclick="testCTAClick()">Test CTA Click</button>
        </div>

        <div class="test-section">
            <h3>üõ§Ô∏è User Journey Events</h3>
            <button onclick="testFunnelStep()">Test Funnel Step</button>
            <button onclick="testPageEngagement()">Test Page Engagement</button>
            <button onclick="testScrollMilestone()">Test Scroll Milestone</button>
            <button onclick="testUserJourney()">Test Complete User Journey</button>
        </div>

        <div class="test-section">
            <h3>üîß System Events</h3>
            <button onclick="testPageView()">Test Page View</button>
            <button onclick="testPerformance()">Test Performance</button>
            <button onclick="testError()">Test Error Tracking</button>
            <button onclick="testABTest()">Test A/B Test</button>
        </div>

        <div class="test-section">
            <h3>üìä Batch Testing</h3>
            <button onclick="runAllTests()">Run All Tests</button>
            <button onclick="runLeadGenerationTests()">Run Lead Generation Tests</button>
            <button onclick="runEngagementTests()">Run Engagement Tests</button>
            <button onclick="runConversionTests()">Run Conversion Tests</button>
        </div>

        <div class="test-results" id="test-results">
            <h3>Test Results</h3>
            <div id="results-content">
                <div class="test-result info">
                    <strong>Ready to test!</strong> Click any button above to test your GA4 events.
                    <br>Make sure to have GA4 DebugView open to see events in real-time.
                </div>
            </div>
        </div>
    </div>

    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XXXXXXXXXX', {
            debug_mode: true,
            send_page_view: true
        });
    </script>

    <!-- Key Events Tracker -->
    <script type="module">
        // Mock key events tracker for testing
        class MockKeyEventsTracker {
            constructor() {
                this.events = [];
                this.sessionId = 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                this.init();
            }

            init() {
                console.log('üéØ Mock Key Events Tracker Initialized');
                this.updateDebugDashboard();
                setInterval(() => this.updateDebugDashboard(), 1000);
            }

            trackKeyEvent(eventType, eventData = {}) {
                const event = {
                    event_type: eventType,
                    event_data: {
                        ...eventData,
                        timestamp: Date.now(),
                        session_id: this.sessionId,
                        debug_mode: true,
                        page_url: window.location.href,
                        page_title: document.title
                    },
                    tracked_at: Date.now()
                };

                this.events.push(event);
                
                // Send to GA4
                if (typeof gtag !== 'undefined') {
                    gtag('event', eventType, event.event_data);
                }

                console.log(`üîç Event tracked: ${eventType}`, event.event_data);
                this.updateDebugDashboard();
                
                return event;
            }

            updateDebugDashboard() {
                const sessionIdEl = document.getElementById('session-id');
                const eventsCountEl = document.getElementById('events-count');
                const debugModeEl = document.getElementById('debug-mode');
                const lastEventEl = document.getElementById('last-event');
                const testCountEl = document.getElementById('test-count');

                if (sessionIdEl) sessionIdEl.textContent = this.sessionId;
                if (eventsCountEl) eventsCountEl.textContent = this.events.length;
                if (debugModeEl) debugModeEl.textContent = window.location.search.includes('debug_mode=true') ? 'Yes' : 'No';
                if (lastEventEl) lastEventEl.textContent = this.events[this.events.length - 1]?.event_type || 'None';
                if (testCountEl) testCountEl.textContent = document.querySelectorAll('.test-result').length;
            }

            clearEvents() {
                this.events = [];
                this.updateDebugDashboard();
            }
        }

        // Initialize tracker
        const tracker = new MockKeyEventsTracker();

        // Test functions
        window.testEmailCapture = () => {
            const result = tracker.trackKeyEvent('email_capture', {
                source: 'test_page',
                tool: 'chatgpt',
                category: 'ai_tools',
                email_domain: 'test.com',
                label: 'email_capture_test_page'
            });
            logTestResult('Email Capture', result, 'success');
        };

        window.testWebinarRegistration = () => {
            const result = tracker.trackKeyEvent('webinar_registration', {
                webinar_title: 'AI Tools Masterclass 2025',
                email: 'test@example.com',
                source: 'test_page',
                label: 'webinar_registration_test'
            });
            logTestResult('Webinar Registration', result, 'success');
        };

        window.testGuideDownload = () => {
            const result = tracker.trackKeyEvent('guide_download', {
                file_name: 'AI_Tools_Guide_2025.pdf',
                source: 'test_page',
                tool_context: 'chatgpt_vs_jasper',
                label: 'guide_download_test'
            });
            logTestResult('Guide Download', result, 'success');
        };

        window.testPricingQuote = () => {
            const result = tracker.trackKeyEvent('pricing_quote_request', {
                source: 'test_page',
                tools_requested: ['chatgpt', 'jasper_ai'],
                team_size: 10,
                label: 'pricing_quote_test'
            });
            logTestResult('Pricing Quote Request', result, 'success');
        };

        window.testComparisonView = () => {
            const result = tracker.trackKeyEvent('comparison_view', {
                tool_1: 'chatgpt',
                tool_2: 'jasper_ai',
                source: 'test_page',
                label: 'comparison_view_test'
            });
            logTestResult('Comparison View', result, 'success');
        };

        window.testCalculatorUsage = () => {
            const result = tracker.trackKeyEvent('calculator_usage', {
                tools_selected: ['chatgpt', 'jasper_ai'],
                team_size: 5,
                usage_level: 'medium',
                total_cost: 150,
                label: 'calculator_usage_test'
            });
            logTestResult('Calculator Usage', result, 'success');
        };

        window.testFAQInteraction = () => {
            const result = tracker.trackKeyEvent('faq_interaction', {
                question: 'What is the difference between ChatGPT and Jasper AI?',
                tool_context: 'chatgpt_vs_jasper',
                action: 'opened',
                label: 'faq_interaction_test'
            });
            logTestResult('FAQ Interaction', result, 'success');
        };

        window.testToolSelection = () => {
            const result = tracker.trackKeyEvent('tool_selection', {
                tool_name: 'chatgpt',
                selected: true,
                total_selected: 2,
                label: 'tool_selection_test'
            });
            logTestResult('Tool Selection', result, 'success');
        };

        window.testFeatureComparison = () => {
            const result = tracker.trackKeyEvent('feature_comparison', {
                feature: 'pricing',
                tool_1: 'chatgpt',
                tool_2: 'jasper_ai',
                label: 'feature_comparison_test'
            });
            logTestResult('Feature Comparison', result, 'success');
        };

        window.testAffiliateClick = () => {
            const result = tracker.trackKeyEvent('affiliate_click', {
                tool_name: 'chatgpt',
                link_type: 'pricing',
                destination: 'https://chat.openai.com/plus',
                position: 'test_button',
                label: 'affiliate_click_test'
            });
            logTestResult('Affiliate Click', result, 'success');
        };

        window.testToolSignup = () => {
            const result = tracker.trackKeyEvent('tool_signup', {
                tool_name: 'chatgpt',
                plan_type: 'plus',
                source: 'test_page',
                label: 'tool_signup_test'
            });
            logTestResult('Tool Signup', result, 'success');
        };

        window.testCTAClick = () => {
            const result = tracker.trackKeyEvent('cta_click', {
                cta_type: 'pricing_button',
                tool_name: 'chatgpt',
                position: 'test_section',
                label: 'cta_click_test'
            });
            logTestResult('CTA Click', result, 'success');
        };

        window.testFunnelStep = () => {
            const result = tracker.trackKeyEvent('funnel_step', {
                step: 'comparison_viewed',
                funnel_step_number: 2,
                comparison: 'chatgpt_vs_jasper',
                label: 'funnel_step_test'
            });
            logTestResult('Funnel Step', result, 'success');
        };

        window.testPageEngagement = () => {
            const result = tracker.trackKeyEvent('page_engagement', {
                page_name: 'test_page',
                engagement_time: 30000,
                scroll_depth: 75,
                label: 'page_engagement_test'
            });
            logTestResult('Page Engagement', result, 'success');
        };

        window.testScrollMilestone = () => {
            const result = tracker.trackKeyEvent('scroll_milestone', {
                milestone: 50,
                page: 'test_page',
                label: 'scroll_milestone_test'
            });
            logTestResult('Scroll Milestone', result, 'success');
        };

        window.testUserJourney = () => {
            // Simulate a complete user journey
            const steps = [
                { event: 'page_view', data: { page_type: 'test_page' } },
                { event: 'comparison_view', data: { tool_1: 'chatgpt', tool_2: 'jasper_ai' } },
                { event: 'calculator_usage', data: { tools_selected: ['chatgpt'], team_size: 5 } },
                { event: 'email_capture', data: { source: 'test_page' } },
                { event: 'affiliate_click', data: { tool_name: 'chatgpt' } }
            ];

            steps.forEach((step, index) => {
                setTimeout(() => {
                    const result = tracker.trackKeyEvent(step.event, step.data);
                    logTestResult(`User Journey Step ${index + 1}: ${step.event}`, result, 'success');
                }, index * 500);
            });
        };

        window.testPageView = () => {
            const result = tracker.trackKeyEvent('page_view', {
                page_title: document.title,
                page_location: window.location.href,
                referrer: document.referrer,
                label: 'page_view_test'
            });
            logTestResult('Page View', result, 'success');
        };

        window.testPerformance = () => {
            const result = tracker.trackKeyEvent('page_performance', {
                page: 'test_page',
                load_time_ms: 1500,
                label: 'performance_test'
            });
            logTestResult('Performance', result, 'success');
        };

        window.testError = () => {
            const result = tracker.trackKeyEvent('error', {
                error_type: 'test_error',
                error_message: 'This is a test error',
                context: { test: true },
                label: 'error_test'
            });
            logTestResult('Error Tracking', result, 'success');
        };

        window.testABTest = () => {
            const result = tracker.trackKeyEvent('ab_test', {
                test_name: 'cta_button_color',
                variant: 'blue',
                converted: false,
                label: 'ab_test_test'
            });
            logTestResult('A/B Test', result, 'success');
        };

        // Batch test functions
        window.runAllTests = () => {
            const tests = [
                'testEmailCapture', 'testWebinarRegistration', 'testGuideDownload',
                'testPricingQuote', 'testComparisonView', 'testCalculatorUsage',
                'testFAQInteraction', 'testToolSelection', 'testFeatureComparison',
                'testAffiliateClick', 'testToolSignup', 'testCTAClick',
                'testFunnelStep', 'testPageEngagement', 'testScrollMilestone',
                'testPageView', 'testPerformance', 'testError', 'testABTest'
            ];

            tests.forEach((test, index) => {
                setTimeout(() => {
                    window[test]();
                }, index * 200);
            });
        };

        window.runLeadGenerationTests = () => {
            const tests = ['testEmailCapture', 'testWebinarRegistration', 'testGuideDownload', 'testPricingQuote'];
            tests.forEach((test, index) => {
                setTimeout(() => window[test](), index * 200);
            });
        };

        window.runEngagementTests = () => {
            const tests = ['testComparisonView', 'testCalculatorUsage', 'testFAQInteraction', 'testToolSelection', 'testFeatureComparison'];
            tests.forEach((test, index) => {
                setTimeout(() => window[test](), index * 200);
            });
        };

        window.runConversionTests = () => {
            const tests = ['testAffiliateClick', 'testToolSignup', 'testCTAClick'];
            tests.forEach((test, index) => {
                setTimeout(() => window[test](), index * 200);
            });
        };

        // Utility functions
        function logTestResult(eventType, result, status) {
            const resultsContent = document.getElementById('results-content');
            const timestamp = new Date().toLocaleTimeString();
            const statusClass = status === 'success' ? 'success' : status === 'error' ? 'error' : 'info';
            
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${statusClass}`;
            resultDiv.innerHTML = `
                <strong>${eventType}</strong> - ${status.toUpperCase()} at ${timestamp}
                <br>Event Type: ${result.event_type}
                <br>Session ID: ${result.event_data.session_id}
                <br>Data: ${JSON.stringify(result.event_data, null, 2)}
            `;
            
            resultsContent.appendChild(resultDiv);
            resultsContent.scrollTop = resultsContent.scrollHeight;
        }

        window.clearDebugData = () => {
            tracker.clearEvents();
            document.getElementById('results-content').innerHTML = `
                <div class="test-result info">
                    <strong>Data cleared!</strong> All test results and events have been cleared.
                </div>
            `;
        };

        // Initialize page view
        setTimeout(() => {
            tracker.trackKeyEvent('page_view', {
                page_title: document.title,
                page_location: window.location.href,
                referrer: document.referrer,
                label: 'test_page_loaded'
            });
        }, 1000);
    </script>
</body>
</html>
