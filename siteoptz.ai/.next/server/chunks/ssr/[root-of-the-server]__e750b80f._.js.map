{"version":3,"sources":["../../../../pages/_app.js","../../../../components/AuthModal.jsx","../../../../utils/auth.js","../../../../components/Navigation.jsx"],"sourcesContent":["import { useEffect } from 'react';\nimport { SessionProvider } from 'next-auth/react';\nimport AuthModal from '../components/AuthModal';\nimport Navigation from '../components/Navigation';\nimport { getAuth } from '../utils/auth';\nimport '../styles/globals.css';\n\nfunction MyApp({ Component, pageProps: { session, ...pageProps } }) {\n  useEffect(() => {\n    // CRITICAL: Prevent any redirect to optz.siteoptz.ai\n    // Use a safer approach that doesn't override browser methods\n    \n    // Function to check and fix URLs\n    const checkAndFixRedirects = () => {\n      // Monitor for any programmatic redirects in the application\n      if (typeof window !== 'undefined') {\n        // Log current URL for debugging\n        console.log('Current URL:', window.location.href);\n        \n        // Check if current URL contains optz.siteoptz.ai and redirect if needed\n        if (window.location.href.includes('optz.siteoptz.ai')) {\n          console.error('BLOCKED: Currently on optz.siteoptz.ai, redirecting to siteoptz.ai');\n          const newUrl = window.location.href\n            .replace('https://optz.siteoptz.ai', 'https://siteoptz.ai')\n            .replace('http://optz.siteoptz.ai', 'https://siteoptz.ai');\n          \n          // Use a clean redirect approach\n          window.location.href = newUrl;\n          return;\n        }\n      }\n    };\n    \n    // Run the check immediately\n    checkAndFixRedirects();\n    \n    // Set up interval to periodically check (as a safety net)\n    const intervalId = setInterval(checkAndFixRedirects, 1000);\n    \n    // Initialize authentication system\n    const auth = getAuth();\n    \n    // Optional: Check if user is authenticated on app load\n    if (auth && auth.isAuthenticated()) {\n      console.log('User is authenticated:', auth.getCurrentUser());\n    }\n    \n    // Cleanup interval on unmount\n    return () => {\n      clearInterval(intervalId);\n    };\n  }, []);\n\n  return (\n    <SessionProvider session={session}>\n      <Navigation />\n      <Component {...pageProps} />\n      <AuthModal />\n    </SessionProvider>\n  );\n}\n\nexport default MyApp;","import { useEffect } from 'react';\n\nexport default function AuthModal() {\n  useEffect(() => {\n    // Listen for show login/register events and redirect instead\n    const handleShowLogin = () => {\n      window.open('https://api.leadconnectorhq.com/widget/booking/yPjkVmsauPst8XlrOQUl', '_blank');\n    };\n    \n    const handleShowRegister = () => {\n      window.open('https://api.leadconnectorhq.com/widget/booking/yPjkVmsauPst8XlrOQUl', '_blank');\n    };\n    \n    window.addEventListener('siteoptz:show-login', handleShowLogin);\n    window.addEventListener('siteoptz:show-register', handleShowRegister);\n    \n    // Check initial hash and redirect\n    const hash = window.location.hash.toLowerCase();\n    if (hash === '#login' || hash === '#/login' || hash === '#register' || hash === '#/register') {\n      window.open('https://api.leadconnectorhq.com/widget/booking/yPjkVmsauPst8XlrOQUl', '_blank');\n    }\n    \n    return () => {\n      window.removeEventListener('siteoptz:show-login', handleShowLogin);\n      window.removeEventListener('siteoptz:show-register', handleShowRegister);\n    };\n  }, []);\n\n  // This component no longer renders any UI\n  return null;\n}","/**\n * Authentication utilities for SiteOptz.ai\n * Handles login/register with GoHighLevel integration\n */\n\n// Authentication class for managing user authentication\nclass SiteOptzAuth {\n  constructor() {\n    this.user = this.loadUser();\n    this.initHashRouting();\n  }\n\n  /**\n   * Initialize hash-based routing for login/register\n   */\n  initHashRouting() {\n    if (typeof window !== 'undefined') {\n      // Listen for hash changes\n      window.addEventListener('hashchange', () => this.handleHashRoute());\n      \n      // Check initial hash\n      window.addEventListener('load', () => this.handleHashRoute());\n      \n      // Handle initial route\n      this.handleHashRoute();\n    }\n  }\n\n  /**\n   * Handle hash-based routing\n   */\n  handleHashRoute() {\n    if (typeof window === 'undefined') return;\n    \n    const hash = window.location.hash.toLowerCase();\n    \n    if (hash === '#login' || hash === '#/login') {\n      this.showLoginModal();\n    } else if (hash === '#register' || hash === '#/register') {\n      this.showRegisterModal();\n    } else if (hash === '#logout' || hash === '#/logout') {\n      this.logout();\n    }\n  }\n\n  /**\n   * Show login modal\n   */\n  showLoginModal() {\n    // Dispatch event for React components to handle\n    if (typeof window !== 'undefined') {\n      window.dispatchEvent(new CustomEvent('siteoptz:show-login'));\n    }\n  }\n\n  /**\n   * Show register modal\n   */\n  showRegisterModal() {\n    // Dispatch event for React components to handle\n    if (typeof window !== 'undefined') {\n      window.dispatchEvent(new CustomEvent('siteoptz:show-register'));\n    }\n  }\n\n  /**\n   * Handle login\n   */\n  async login(email, password) {\n    try {\n      const response = await fetch('/api/auth/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ email, password })\n      });\n\n      // Log response for debugging\n      console.log('Login API response status:', response.status);\n      \n      const data = await response.json();\n      console.log('Login API response data:', data);\n\n      if (data.success) {\n        // Save user data\n        this.saveUser(data.user);\n        \n        // Log successful login for debugging\n        console.log('Login successful:', {\n          email: data.user.email,\n          plan: data.user.plan,\n          redirectUrl: data.redirectUrl\n        });\n        \n        // Dispatch success event\n        this.dispatchAuthEvent('login', data.user);\n        \n        // Ensure we have a valid redirect URL with the plan\n        const redirectUrl = data.redirectUrl || `https://siteoptz.ai/dashboard/${data.user.plan || 'free'}`;\n        \n        // Redirect to dashboard after short delay\n        setTimeout(() => {\n          console.log('Redirecting to:', redirectUrl);\n          window.location.href = redirectUrl;\n        }, 1500);\n        \n        return {\n          success: true,\n          user: data.user,\n          message: data.message,\n          redirectUrl: redirectUrl\n        };\n      } else {\n        // Handle specific error types\n        if (data.error === 'user_not_found') {\n          return {\n            success: false,\n            error: 'user_not_found',\n            message: data.message,\n            action: 'redirect_to_register'\n          };\n        } else if (data.error === 'invalid_password') {\n          return {\n            success: false,\n            error: 'invalid_password',\n            message: data.message\n          };\n        } else {\n          return {\n            success: false,\n            error: data.error || 'login_failed',\n            message: data.message || 'Login failed. Please try again.'\n          };\n        }\n      }\n    } catch (error) {\n      console.error('Login error:', error);\n      return {\n        success: false,\n        error: 'network_error',\n        message: 'Unable to connect. Please check your connection and try again.'\n      };\n    }\n  }\n\n  /**\n   * Handle registration\n   */\n  async register(name, email, password, plan = 'free') {\n    try {\n      const response = await fetch('/api/auth/register', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ name, email, password, plan })\n      });\n\n      const data = await response.json();\n\n      if (data.success) {\n        // Save user data\n        this.saveUser(data.user);\n        \n        // Dispatch success event\n        this.dispatchAuthEvent('register', data.user);\n        \n        // Redirect to dashboard after short delay\n        setTimeout(() => {\n          window.location.href = data.redirectUrl;\n        }, 1500);\n        \n        return {\n          success: true,\n          user: data.user,\n          message: data.message,\n          redirectUrl: data.redirectUrl\n        };\n      } else {\n        // Handle specific error types\n        if (data.error === 'user_exists') {\n          return {\n            success: false,\n            error: 'user_exists',\n            message: data.message,\n            action: 'redirect_to_login'\n          };\n        } else {\n          return {\n            success: false,\n            error: data.error || 'registration_failed',\n            message: data.message || 'Registration failed. Please try again.'\n          };\n        }\n      }\n    } catch (error) {\n      console.error('Registration error:', error);\n      return {\n        success: false,\n        error: 'network_error',\n        message: 'Unable to connect. Please check your connection and try again.'\n      };\n    }\n  }\n\n  /**\n   * Logout user\n   */\n  logout() {\n    this.user = null;\n    if (typeof window !== 'undefined') {\n      localStorage.removeItem('siteoptz_user');\n      window.location.hash = '';\n      this.dispatchAuthEvent('logout');\n    }\n  }\n\n  /**\n   * Save user to localStorage\n   */\n  saveUser(userData) {\n    this.user = userData;\n    if (typeof window !== 'undefined') {\n      localStorage.setItem('siteoptz_user', JSON.stringify(userData));\n    }\n  }\n\n  /**\n   * Load user from localStorage\n   */\n  loadUser() {\n    if (typeof window !== 'undefined') {\n      try {\n        const userData = localStorage.getItem('siteoptz_user');\n        return userData ? JSON.parse(userData) : null;\n      } catch (error) {\n        return null;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Get current user\n   */\n  getCurrentUser() {\n    return this.user;\n  }\n\n  /**\n   * Check if user is authenticated\n   */\n  isAuthenticated() {\n    return !!(this.user && this.user.authenticated);\n  }\n\n  /**\n   * Check if user has access to specific plan\n   */\n  hasAccessToPlan(requiredPlan) {\n    if (!this.user) return false;\n    \n    const planHierarchy = {\n      'free': 1,\n      'starter': 2,\n      'pro': 3,\n      'enterprise': 4\n    };\n    \n    const userLevel = planHierarchy[this.user.plan] || 0;\n    const requiredLevel = planHierarchy[requiredPlan] || 0;\n    \n    return userLevel >= requiredLevel;\n  }\n\n  /**\n   * Dispatch authentication events\n   */\n  dispatchAuthEvent(type, data = null) {\n    if (typeof window !== 'undefined') {\n      window.dispatchEvent(new CustomEvent(`siteoptz:${type}`, { detail: data }));\n    }\n  }\n}\n\n// Create singleton instance\nlet authInstance = null;\n\nexport const getAuth = () => {\n  if (typeof window !== 'undefined' && !authInstance) {\n    authInstance = new SiteOptzAuth();\n  }\n  return authInstance;\n};\n\n// Export convenience functions\nexport const login = (email, password) => {\n  const auth = getAuth();\n  return auth ? auth.login(email, password) : Promise.reject(new Error('Auth not initialized'));\n};\n\nexport const register = (name, email, password, plan) => {\n  const auth = getAuth();\n  return auth ? auth.register(name, email, password, plan) : Promise.reject(new Error('Auth not initialized'));\n};\n\nexport const logout = () => {\n  const auth = getAuth();\n  return auth ? auth.logout() : null;\n};\n\nexport const getCurrentUser = () => {\n  const auth = getAuth();\n  return auth ? auth.getCurrentUser() : null;\n};\n\nexport const isAuthenticated = () => {\n  const auth = getAuth();\n  return auth ? auth.isAuthenticated() : false;\n};\n\nexport default {\n  getAuth,\n  login,\n  register,\n  logout,\n  getCurrentUser,\n  isAuthenticated\n};","import { useState, useEffect } from 'react';\nimport { getCurrentUser, logout } from '../utils/auth';\n\nexport default function Navigation() {\n  const [user, setUser] = useState(null);\n\n  useEffect(() => {\n    // Check if user is logged in\n    const currentUser = getCurrentUser();\n    setUser(currentUser);\n\n    // Listen for auth events\n    const handleLogin = (e) => {\n      setUser(e.detail);\n    };\n\n    const handleLogout = () => {\n      setUser(null);\n    };\n\n    window.addEventListener('siteoptz:login', handleLogin);\n    window.addEventListener('siteoptz:register', handleLogin);\n    window.addEventListener('siteoptz:logout', handleLogout);\n\n    return () => {\n      window.removeEventListener('siteoptz:login', handleLogin);\n      window.removeEventListener('siteoptz:register', handleLogin);\n      window.removeEventListener('siteoptz:logout', handleLogout);\n    };\n  }, []);\n\n  const handleLogout = () => {\n    logout();\n  };\n\n  const handleDashboardClick = (e) => {\n    e.preventDefault();\n    if (user && user.plan) {\n      window.location.href = `https://siteoptz.ai/dashboard/${user.plan}`;\n    }\n  };\n\n  return (\n    <nav className=\"navigation\">\n      <div className=\"nav-container\">\n        <div className=\"nav-logo\">\n          <a href=\"/\">ðŸš€ SiteOptz.ai</a>\n        </div>\n        \n        <div className=\"nav-links\">\n          <a href=\"/compare\">AI Tools</a>\n          <a href=\"/pricing\">Pricing</a>\n          <a href=\"/features\">Features</a>\n        </div>\n\n        <div className=\"auth-nav\">\n          {user && user.authenticated ? (\n            <div className=\"user-info\">\n              <span className=\"user-email\">{user.email}</span>\n              <span className=\"user-plan\">{user.plan}</span>\n              <a \n                href={`https://siteoptz.ai/dashboard/${user.plan}`}\n                onClick={handleDashboardClick}\n                className=\"dashboard-link\"\n              >\n                Dashboard\n              </a>\n              <button onClick={handleLogout} className=\"logout-btn\">\n                Logout\n              </button>\n            </div>\n          ) : (\n            <a \n              href=\"https://api.leadconnectorhq.com/widget/booking/yPjkVmsauPst8XlrOQUl\" \n              target=\"_blank\" \n              rel=\"noopener noreferrer\" \n              className=\"auth-btn-register\"\n            >\n              Get Started\n            </a>\n          )}\n        </div>\n      </div>\n\n      <style jsx>{`\n        .navigation {\n          position: sticky;\n          top: 0;\n          background: white;\n          border-bottom: 1px solid #eee;\n          z-index: 100;\n          padding: 1rem 0;\n        }\n\n        .nav-container {\n          max-width: 1200px;\n          margin: 0 auto;\n          padding: 0 1rem;\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n        }\n\n        .nav-logo a {\n          font-size: 1.5rem;\n          font-weight: bold;\n          color: #333;\n          text-decoration: none;\n        }\n\n        .nav-links {\n          display: flex;\n          gap: 2rem;\n          flex: 1;\n          justify-content: center;\n        }\n\n        .nav-links a {\n          color: #666;\n          text-decoration: none;\n          font-weight: 500;\n          transition: color 0.3s;\n        }\n\n        .nav-links a:hover {\n          color: #4CAF50;\n        }\n\n        .auth-nav {\n          display: flex;\n          gap: 1rem;\n          align-items: center;\n        }\n\n        .auth-btn-register {\n          padding: 0.5rem 1rem;\n          border-radius: 6px;\n          font-weight: 500;\n          text-decoration: none;\n          transition: all 0.3s;\n          background: #4CAF50;\n          color: white;\n        }\n\n        .auth-btn-register:hover {\n          background: #45a049;\n        }\n\n        .user-info {\n          display: flex;\n          align-items: center;\n          gap: 1rem;\n        }\n\n        .user-email {\n          color: #666;\n          font-size: 0.95rem;\n        }\n\n        .user-plan {\n          padding: 0.25rem 0.5rem;\n          background: #4CAF50;\n          color: white;\n          border-radius: 4px;\n          font-size: 0.75rem;\n          text-transform: uppercase;\n          font-weight: 600;\n        }\n\n        .dashboard-link {\n          padding: 0.5rem 1rem;\n          background: #2196F3;\n          color: white;\n          border-radius: 6px;\n          text-decoration: none;\n          font-weight: 500;\n          font-size: 0.95rem;\n          transition: background 0.3s;\n        }\n\n        .dashboard-link:hover {\n          background: #1976D2;\n        }\n\n        .logout-btn {\n          padding: 0.5rem 1rem;\n          background: #f44336;\n          color: white;\n          border: none;\n          border-radius: 6px;\n          cursor: pointer;\n          font-size: 0.95rem;\n          font-weight: 500;\n          transition: background 0.3s;\n        }\n\n        .logout-btn:hover {\n          background: #d32f2f;\n        }\n\n        @media (max-width: 768px) {\n          .nav-container {\n            flex-wrap: wrap;\n          }\n\n          .nav-links {\n            display: none;\n          }\n\n          .auth-nav {\n            margin-left: auto;\n          }\n\n          .user-info {\n            flex-wrap: wrap;\n            gap: 0.5rem;\n          }\n\n          .user-email {\n            display: none;\n          }\n        }\n      `}</style>\n    </nav>\n  );\n}"],"names":[],"mappings":"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"}